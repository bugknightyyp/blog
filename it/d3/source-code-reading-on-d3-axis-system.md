# d3源码解读之坐标系统
tags: [d3]

d3坐标系统本质是data与画板(数据可视化区域)纬度的映射关系。如果把数据呈现到坐标系统里，就需要知道他们之间的映射函数y=f(x)。
画板长宽，一般是我们自定义的，这就是说值域我们已经知道。x、y轴的值域就是画板的长、宽。下面我们还要知道定义域从哪来，很显然定义域是从data(一般是对象数组)来的，分别
求出data里与x或y对应信息的最大值和最小值， 就是定义域的两个临界点。eg:

假设画板的长/宽是200px/100px, data：[{date: "2015-06-09", temp: 26}, {date: "2015-06-10", temp: 24}, {date: "2015-06-11", temp: 18.2}]。
如果要显示一天的平均温度和时间的关系，x、y的定义域和值域分别是什么呢？很显然,x轴表示的是date(时间), 定义域: [2015-06-09, 2015-06-11], 值域: [0, 200];
y轴表示是temp(温度),定义域: [18.2, 26], 值域: [100, 0];

## 坐标轴种类

常见的坐标系统轴，一般分3种，即：
- 常见的普通数字坐标轴
- 时间坐标轴
- 序数比例尺

## 要想画出坐标系统，我们还需要那些事情呢？

- x & y轴各自的映射函数 y = f(x)，d3中名称用的是scale，可以称为比例尺函数;
- 刻度个数，也就是要知道坐标轴上的最小刻度；

下面简要阐述d3是怎么根据画板的长宽和数据区间范围怎么计算出比例尺函数和最小刻度

## 坐标轴通常用法

先生成一个坐标轴方法。eg:
```js
var xAxis = d3.svg.axis()//生成一个X轴对象
  .scale(x)
  .orient("bottom")//设置坐标轴的对齐位置
```
然后通过`call`方法调用`d3.svg.axis()`返回的方法。eg:
```js
d3.select("body")
  .append("svg")
  .append("g")//生成X坐标轴
  .attr("class", "x axis")
  .attr("transform", "translate(0," + height + ")")//设置x坐标轴的位置
  .call(xAxis);//根据所设置的定义域与值域以及对其方式来绘制坐标轴以及刻度线
```
## 坐标轴的结构

每一个轴线是放在一个元素 `g` 里面，它负责定位。
`g > path`负责绘制轴线
`g > g`是盛放每个tiker(刻度数)的容器
`g > g > line` 负责指示刻度的小线段
`g > g > text` 负责显示刻度值



## 几个变量的含义解释

`outerTickSize` 坐标轴上两端刻度指示线的高度(x轴)/宽度(y轴)

`innerTickSize` 坐标轴上中间刻度指示线(两端除外)的高度(x轴)/宽度(y轴)

`tickPadding` 刻度指示线顶端到刻度值之间的距离


[1]:https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial "MDN SVG Tutorial"
[2]:http://www.oxxostudio.tw/articles/201406/svg-08-text.html "svg text element"
